<?

class CookieJar implements avalanche_interface_cookieTray{

	public function setCookie($name , $value = false, $expire = 0, $path = false, $domainIn = false, $secure = false, $flag=false){
		if(!headers_sent($file, $line)){
			$_COOKIE[$name] = $value;
			$domain = $_SERVER["HTTP_HOST"];
			// look for the only '.'
			while(substr_count($domain, ".") > 1 && $domain != $domainIn){
				$domain = substr($domain, strpos($domain, ".")+1);
			}
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////  IE fails sometimes trying to set a cookie with "" value //////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			/////////////////////////////////////////////////////////////////////////////////////////////
			$ret = setcookie($name , $value, $expire, $path, $domain, $secure);
			return $ret;
		}else{
			echo "headers sent at $file $line";
			return false;
		}
	}

	public function getCookie($cook){
		if(isset($_COOKIE[$cook])){
			return $_COOKIE[$cook];
		}else{
			return false;
		}
	}

	public function deleteCookie($name){
		//set a cookie to expire two days ago
		if(isset($_COOKIE[$name])){
			unset($_COOKIE[$name]);
			setcookie($name , "blah", time()-3600*48);
		}
	}
}


?>